syntax = "proto3";

package stela;

service Stela {
    rpc Connect(ConnectRequest) returns (stream ServiceMessage) {}
    rpc Subscribe(SubscribeRequest) returns (SubscribeResponse) {}
    rpc Register(ServiceMessage) returns (RegisteResponse) {}
    rpc Discover(DiscoverRequest) returns (DiscoverResponse) {}
    rpc DiscoverOne(DiscoverRequest) returns (ServiceMessage) {}
}

message SubscribeResponse{}

message RegisteResponse{}

message ServiceMessage {
    string name = 1;
    string hostname = 2;
    string address = 3;
    int32 port = 4;
    int32 priority = 5;
}

message SubscribeRequest {
     string service_name = 1;
}

message DiscoverRequest {
     string service_name = 1;
}

message DiscoverResponse {
    repeated ServiceMessage services = 1;
}

message ConnectRequest {
    string client_uuid = 1;
}